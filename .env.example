#############################################
# Evalis-GT Environment Configuration Template
# Copy to .env (local) & add vars to Vercel dashboard
# Never commit real secrets. This file is safe (no real keys).
#############################################

# Node Environment
NODE_ENV=development

# Server Configuration
PORT=3000
# Optional: Comma-separated list of candidate ports to try in order (overrides incremental fallback logic)
# Example: PORT_CANDIDATES=3001,3002,4000
PORT_CANDIDATES=
FRONTEND_URL=https://your-domain.com
MAX_CONNECTIONS=1000

#############################################
# Database Configuration (Neon / Postgres)
# Primary variable read by code: DATABASE_URL
# Accepted fallbacks: NEON_DB_URL, POSTGRES_URL, PG_URL
#############################################
DATABASE_URL=postgres://USER:PASSWORD@HOST:5432/DBNAME?sslmode=require
# Neon example (replace placeholders) -- prefer including ?sslmode=require to force TLS
# DATABASE_URL=postgres://<user>:<password>@ep-<endpoint-id>.us-east-2.aws.neon.tech/<database>?sslmode=require
# NEON_DB_URL=
# POSTGRES_URL=
# PG_URL=

#############################################
# Authentication & Security
#############################################
JWT_SECRET=replace_with_long_random_min_48_chars
JWT_EXPIRE=24h
DEFAULT_ADMIN_PASSWORD=change_me_first_login
SESSION_STRICT=false
ALLOW_PASSWORD_FALLBACK=true

#############################################
# Firebase Configuration
# Choose one of FIREBASE_SERVICE_ACCOUNT_JSON OR FIREBASE_SERVICE_ACCOUNT_B64
# (Service account JSON one-line with \n for newlines in private_key)
#############################################
# FIREBASE_SERVICE_ACCOUNT_JSON={"type":"service_account","project_id":"your-project","private_key_id":"...","private_key":"-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n","client_email":"firebase-adminsdk@your-project.iam.gserviceaccount.com","client_id":"...","auth_uri":"https://accounts.google.com/o/oauth2/auth","token_uri":"https://oauth2.googleapis.com/token","auth_provider_x509_cert_url":"https://www.googleapis.com/oauth2/v1/certs","client_x509_cert_url":"https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk%40your-project.iam.gserviceaccount.com"}
# Or base64 encoded whole JSON file:
# FIREBASE_SERVICE_ACCOUNT_B64=base64_encoded_json_here

# Firebase Web (client) config – also duplicated with VITE_ prefix for frontend build
FIREBASE_API_KEY=your_web_api_key
FIREBASE_AUTH_DOMAIN=your-project.firebaseapp.com
FIREBASE_PROJECT_ID=your-project
FIREBASE_STORAGE_BUCKET=your-project.appspot.com
FIREBASE_MESSAGING_SENDER_ID=123456789012
FIREBASE_APP_ID=1:123456789012:web:abcdef1234567890
FIREBASE_MEASUREMENT_ID=G-XXXXXXXXXX

# Email Configuration (Optional)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password

#############################################
# Rate Limiting
#############################################
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX=120
AUTH_RATE_LIMIT_WINDOW_MS=900000
AUTH_RATE_LIMIT_MAX_REQUESTS=5

#############################################
# File Upload / Storage
#############################################
MAX_FILE_SIZE=10485760
UPLOAD_PATH=./server/uploads

#############################################
# Monitoring & Logging
#############################################
LOG_LEVEL=info
ENABLE_REQUEST_LOGGING=true
DB_LOG_SQL=false

#############################################
# Health Check
#############################################
HEALTH_CHECK_TIMEOUT=5000

#############################################
# Redis (optional future scaling)
#############################################
REDIS_URL=redis://localhost:6379
ENABLE_REDIS_CACHE=false

#############################################
# Frontend (Vite) – MUST start with VITE_
#############################################
VITE_API_BASE_URL=/api
VITE_FIREBASE_API_KEY=${FIREBASE_API_KEY}
VITE_FIREBASE_AUTH_DOMAIN=${FIREBASE_AUTH_DOMAIN}
VITE_FIREBASE_PROJECT_ID=${FIREBASE_PROJECT_ID}
VITE_FIREBASE_STORAGE_BUCKET=${FIREBASE_STORAGE_BUCKET}
VITE_FIREBASE_MESSAGING_SENDER_ID=${FIREBASE_MESSAGING_SENDER_ID}
VITE_FIREBASE_APP_ID=${FIREBASE_APP_ID}
VITE_FIREBASE_MEASUREMENT_ID=${FIREBASE_MEASUREMENT_ID}

#############################################
# Optional Debug Toggles
#############################################
# Log raw SQL (server/config/db.js) when diagnosing 500s (avoid in production unless needed)
# DB_LOG_SQL=true
# Increase auth logging verbosity via NODE_ENV=development or adjust logger level

#############################################
# Notes:
# 1. Add only required vars to Vercel. Frontend rebuild required after changing any VITE_ var.
# 2. Keep production JWT_SECRET different from local.
# 3. Rotate DEFAULT_ADMIN_PASSWORD after first login (or unset it later).
#############################################
